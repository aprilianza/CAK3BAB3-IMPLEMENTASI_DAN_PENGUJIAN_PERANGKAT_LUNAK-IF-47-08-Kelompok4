name: Deploy to GitHub Pages (Alternative)

# Workflow alternatif untuk deploy ke GitHub Pages
on:
  push:
    branches: [ main, programmer ]
  workflow_dispatch:

permissions:
  contents: read
  pages: write
  id-token: write

concurrency:
  group: "pages"
  cancel-in-progress: false

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Detect repository settings
        id: settings
        run: |
          echo "Repository: ${{ github.repository }}"
          echo "Branch: ${{ github.ref_name }}"
          echo "repository_name=${GITHUB_REPOSITORY#*/}" >> $GITHUB_OUTPUT

      - name: Build site
        run: |
          mkdir -p public
          
          # Copy main files
          if [ -f "main.html" ]; then
            cp main.html public/index.html
            echo "‚úÖ Copied main.html as index.html"
          else
            echo "‚ùå main.html not found!"
            exit 1
          fi
          
          # Copy assets
          cp *.png public/ 2>/dev/null || echo "No PNG files"
          cp *.jpg public/ 2>/dev/null || echo "No JPG files"
          cp *.jpeg public/ 2>/dev/null || echo "No JPEG files"
          cp *.gif public/ 2>/dev/null || echo "No GIF files"
          cp *.svg public/ 2>/dev/null || echo "No SVG files"
          cp *.css public/ 2>/dev/null || echo "No CSS files"
          cp *.js public/ 2>/dev/null || echo "No JS files"
          
          # Copy directories if they exist
          [ -d "assets" ] && cp -r assets public/
          [ -d "images" ] && cp -r images public/
          [ -d "css" ] && cp -r css public/
          [ -d "js" ] && cp -r js public/
          
          # Create 404 page
          cat > public/404.html << 'EOF'
          <!DOCTYPE html>
          <html lang="id">
          <head>
              <meta charset="UTF-8">
              <meta name="viewport" content="width=device-width, initial-scale=1.0">
              <title>404 - Halaman Tidak Ditemukan | Hall of Fame</title>
              <style>
                  * { margin: 0; padding: 0; box-sizing: border-box; }
                  body {
                      font-family: 'Inter', sans-serif;
                      background: #0f0f23;
                      color: #ffffff;
                      display: flex;
                      justify-content: center;
                      align-items: center;
                      height: 100vh;
                      text-align: center;
                  }
                  .container {
                      padding: 2rem;
                      background: rgba(102, 126, 234, 0.1);
                      border-radius: 16px;
                      backdrop-filter: blur(10px);
                      border: 1px solid rgba(102, 126, 234, 0.2);
                  }
                  h1 { 
                      font-size: 4rem; 
                      margin-bottom: 1rem; 
                      background: linear-gradient(135deg, #667eea, #764ba2);
                      -webkit-background-clip: text;
                      -webkit-text-fill-color: transparent;
                  }
                  p { font-size: 1.2rem; margin-bottom: 2rem; opacity: 0.8; }
                  a {
                      display: inline-block;
                      background: linear-gradient(135deg, #667eea, #764ba2);
                      color: white;
                      padding: 12px 24px;
                      text-decoration: none;
                      border-radius: 8px;
                      transition: transform 0.3s, box-shadow 0.3s;
                  }
                  a:hover { 
                      transform: translateY(-2px);
                      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
                  }
              </style>
          </head>
          <body>
              <div class="container">
                  <h1>404</h1>
                  <p>Halaman yang Anda cari tidak ditemukan</p>
                  <a href="/">üèÜ Kembali ke Hall of Fame</a>
              </div>
          </body>
          </html>
          EOF
          
          echo "üìÅ Files in public directory:"
          ls -la public/

      - name: Setup Pages
        uses: actions/configure-pages@v4
        continue-on-error: true

      - name: Upload to GitHub Pages
        uses: actions/upload-pages-artifact@v3
        with:
          path: ./public

      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
        continue-on-error: true

      - name: Display Results
        run: |
          if [ "${{ steps.deployment.outcome }}" == "success" ]; then
            echo "üéâ Deployment SUCCESS!"
            echo "üåê Website URL: ${{ steps.deployment.outputs.page_url }}"
            echo "‚úÖ Hall of Fame Mahasiswa Kelompok 4 berhasil di-deploy!"
          else
            echo "‚ö†Ô∏è  Deployment mungkin gagal, tapi files sudah di-upload"
            echo "üîß Silakan cek manual di GitHub Pages settings"
            echo "üìç Expected URL: https://${{ github.repository_owner }}.github.io/${{ steps.settings.outputs.repository_name }}/"
          fi